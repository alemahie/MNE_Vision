
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>src.runnables.connectivity_runnable &#8212; MNE Vision 0.1.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">MNE Vision 0.1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for src.runnables.connectivity_runnable</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Connectivity runnable</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>

<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">QRunnable</span><span class="p">,</span> <span class="n">pyqtSignal</span><span class="p">,</span> <span class="n">QObject</span>

<span class="kn">from</span> <span class="nn">mne</span> <span class="kn">import</span> <span class="n">compute_covariance</span><span class="p">,</span> <span class="n">setup_source_space</span><span class="p">,</span> <span class="n">write_source_spaces</span><span class="p">,</span> <span class="n">make_bem_model</span><span class="p">,</span> <span class="n">make_bem_solution</span><span class="p">,</span> \
    <span class="n">write_bem_solution</span><span class="p">,</span> <span class="n">make_forward_solution</span><span class="p">,</span> <span class="n">write_forward_solution</span><span class="p">,</span> <span class="n">extract_label_time_course</span>
<span class="kn">from</span> <span class="nn">mne.minimum_norm</span> <span class="kn">import</span> <span class="n">make_inverse_operator</span><span class="p">,</span> <span class="n">write_inverse_operator</span><span class="p">,</span> <span class="n">read_inverse_operator</span><span class="p">,</span> <span class="n">apply_inverse_epochs</span>
<span class="kn">from</span> <span class="nn">mne_connectivity</span> <span class="kn">import</span> <span class="n">envelope_correlation</span><span class="p">,</span> <span class="n">spectral_connectivity_epochs</span><span class="p">,</span> <span class="n">phase_slope_index</span>

<span class="kn">from</span> <span class="nn">utils.view.error_window</span> <span class="kn">import</span> <span class="n">errorWindow</span>
<span class="kn">from</span> <span class="nn">utils.file_path_search</span> <span class="kn">import</span> <span class="n">get_project_freesurfer_path</span><span class="p">,</span> <span class="n">get_labels_from_subject</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Lemahieu Antoine&quot;</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s2">&quot;Copyright 2022&quot;</span>
<span class="n">__credits__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Lemahieu Antoine&quot;</span><span class="p">]</span>
<span class="n">__license__</span> <span class="o">=</span> <span class="s2">&quot;GNU General Public License v3.0&quot;</span>
<span class="n">__maintainer__</span> <span class="o">=</span> <span class="s2">&quot;Lemahieu Antoine&quot;</span>
<span class="n">__email__</span> <span class="o">=</span> <span class="s2">&quot;Antoine.Lemahieu@ulb.be&quot;</span>
<span class="n">__status__</span> <span class="o">=</span> <span class="s2">&quot;Dev&quot;</span>


<span class="c1"># Envelope Correlation</span>
<div class="viewcode-block" id="envelopeCorrelationWorkerSignals"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.envelopeCorrelationWorkerSignals">[docs]</a><span class="k">class</span> <span class="nc">envelopeCorrelationWorkerSignals</span><span class="p">(</span><span class="n">QObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Contain the signals used by the envelope correlation runnable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">finished</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">()</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">()</span></div>


<span class="c1"># noinspection PyUnresolvedReferences</span>
<div class="viewcode-block" id="envelopeCorrelationRunnable"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.envelopeCorrelationRunnable">[docs]</a><span class="k">class</span> <span class="nc">envelopeCorrelationRunnable</span><span class="p">(</span><span class="n">QRunnable</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_data</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">connectivity_method</span><span class="p">,</span> <span class="n">n_jobs</span><span class="p">,</span> <span class="n">export_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runnable for the computation of the envelope correlation of the dataset.</span>
<span class="sd">        :param file_data: MNE data of the dataset.</span>
<span class="sd">        :type file_data: MNE.Epochs/MNE.Raw</span>
<span class="sd">        :param psi: Check if the computation of the Phase Slope Index must be done. The PSI give an indication to the</span>
<span class="sd">        directionality of the connectivity.</span>
<span class="sd">        :type psi: bool</span>
<span class="sd">        :param fmin: Minimum frequency from which the envelope correlation will be computed.</span>
<span class="sd">        :type fmin: float</span>
<span class="sd">        :param fmax: Maximum frequency from which the envelope correlation will be computed.</span>
<span class="sd">        :type fmax: float</span>
<span class="sd">        :param connectivity_method: Method used for computing the source space connectivity.</span>
<span class="sd">        :type connectivity_method: str</span>
<span class="sd">        :param n_jobs: Number of processes used to compute the source estimation</span>
<span class="sd">        :type n_jobs: int</span>
<span class="sd">        :param export_path: Path where the envelope correlation data will be stored.</span>
<span class="sd">        :type export_path: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signals</span> <span class="o">=</span> <span class="n">envelopeCorrelationWorkerSignals</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">file_data</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">file_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">psi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span> <span class="o">=</span> <span class="n">fmin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span> <span class="o">=</span> <span class="n">fmax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connectivity_method</span> <span class="o">=</span> <span class="n">connectivity_method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">export_path</span> <span class="o">=</span> <span class="n">export_path</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">envelope_correlation_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">psi_data</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="envelopeCorrelationRunnable.run"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.envelopeCorrelationRunnable.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Launch the computation of the envelope correlation on the given data.</span>
<span class="sd">        Notifies the main model that the computation is finished.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute_correlation_data</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="p">:</span>
                <span class="n">correlation_data</span> <span class="o">=</span> <span class="n">phase_slope_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_data</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">psi_data</span> <span class="o">=</span> <span class="n">correlation_data</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_data_export</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;An error as occurred during the computation of the envelope correlation.&quot;</span>
            <span class="n">error_window</span> <span class="o">=</span> <span class="n">errorWindow</span><span class="p">(</span><span class="n">error_message</span><span class="p">,</span> <span class="n">detailed_message</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
            <span class="n">error_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span></div>

<div class="viewcode-block" id="envelopeCorrelationRunnable.compute_correlation_data"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.envelopeCorrelationRunnable.compute_correlation_data">[docs]</a>    <span class="k">def</span> <span class="nf">compute_correlation_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the correct correlation data depending on the method chosen by the user.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity_method</span> <span class="o">==</span> <span class="s2">&quot;envelope_correlation&quot;</span><span class="p">:</span>

            <span class="n">correlation_data</span> <span class="o">=</span> <span class="n">envelope_correlation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_data</span><span class="p">)</span><span class="o">.</span><span class="n">combine</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">envelope_correlation_data</span> <span class="o">=</span> <span class="n">correlation_data</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sfreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_data</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;sfreq&quot;</span><span class="p">]</span>
            <span class="n">correlation_data</span> <span class="o">=</span> <span class="n">spectral_connectivity_epochs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_data</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connectivity_method</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;multitaper&quot;</span><span class="p">,</span>
                                                            <span class="n">sfreq</span><span class="o">=</span><span class="n">sfreq</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span> <span class="n">faverage</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mt_adaptive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                            <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">envelope_correlation_data</span> <span class="o">=</span> <span class="n">correlation_data</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="envelopeCorrelationRunnable.check_data_export"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.envelopeCorrelationRunnable.check_data_export">[docs]</a>    <span class="k">def</span> <span class="nf">check_data_export</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if the envelope correlation data and the PSI must be exported.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">export_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">envelope_correlation_data</span>
            <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_data</span><span class="o">.</span><span class="n">ch_names</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="s2">&quot;-connectivity&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi_data</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="s2">&quot;-PSI&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="envelopeCorrelationRunnable.save_data"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.envelopeCorrelationRunnable.save_data">[docs]</a>    <span class="k">def</span> <span class="nf">save_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If it is the case, create the file and write the data in it.</span>
<span class="sd">        :param data: The data to save, either the connectivity of PSI.</span>
<span class="sd">        :type data: list of, list of float</span>
<span class="sd">        :param channels: The channels names to save.</span>
<span class="sd">        :type channels: list of str</span>
<span class="sd">        :param file_name: The name of the data to save.</span>
<span class="sd">        :type file_name: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_path</span> <span class="o">+</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="c1"># Write header</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">channels</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Write data</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>  <span class="c1"># Channels 1</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>  <span class="c1"># Channels 2</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Getters</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="envelopeCorrelationRunnable.get_envelope_correlation_data"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.envelopeCorrelationRunnable.get_envelope_correlation_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_envelope_correlation_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the envelope correlation&#39;s data.</span>
<span class="sd">        :return: The envelope correlation&#39;s data.</span>
<span class="sd">        :rtype: list of, list of float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">envelope_correlation_data</span></div>

<div class="viewcode-block" id="envelopeCorrelationRunnable.get_psi_data"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.envelopeCorrelationRunnable.get_psi_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_psi_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the psi&#39;s data.</span>
<span class="sd">        :return: The psi&#39;s data. Or nothing if the psi&#39;s data has not been computed.</span>
<span class="sd">        :rtype: list of, list of float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi_data</span></div></div>


<span class="c1"># Source Space Connectivity</span>
<div class="viewcode-block" id="sourceSpaceConnectivityWorkerSignals"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sourceSpaceConnectivityWorkerSignals">[docs]</a><span class="k">class</span> <span class="nc">sourceSpaceConnectivityWorkerSignals</span><span class="p">(</span><span class="n">QObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Contain the signals used by the source space connectivity runnable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">finished</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">()</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">()</span></div>


<span class="c1"># noinspection PyUnresolvedReferences</span>
<div class="viewcode-block" id="sourceSpaceConnectivityRunnable"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sourceSpaceConnectivityRunnable">[docs]</a><span class="k">class</span> <span class="nc">sourceSpaceConnectivityRunnable</span><span class="p">(</span><span class="n">QRunnable</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_data</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">connectivity_method</span><span class="p">,</span> <span class="n">spectrum_estimation_method</span><span class="p">,</span> <span class="n">source_estimation_method</span><span class="p">,</span>
                 <span class="n">save_data</span><span class="p">,</span> <span class="n">load_data</span><span class="p">,</span> <span class="n">n_jobs</span><span class="p">,</span> <span class="n">export_path</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runnable for the computation of the source space connectivity of the dataset.</span>
<span class="sd">        :param file_data: MNE data of the dataset.</span>
<span class="sd">        :type file_data: MNE.Epochs/MNE.Raw</span>
<span class="sd">        :param file_path: Path to the file.</span>
<span class="sd">        :type file_path: str</span>
<span class="sd">        :param connectivity_method: Method used for computing the source space connectivity.</span>
<span class="sd">        :type connectivity_method: str</span>
<span class="sd">        :param spectrum_estimation_method: Method used for computing the spectrum estimation used inside the computation</span>
<span class="sd">        of the source space connectivity.</span>
<span class="sd">        :type spectrum_estimation_method: str</span>
<span class="sd">        :param source_estimation_method: Method used for computing the source estimation used inside the computation of</span>
<span class="sd">        the source space connectivity.</span>
<span class="sd">        :type source_estimation_method: str</span>
<span class="sd">        :param save_data: Boolean telling if the data computed must be saved into files.</span>
<span class="sd">        :type save_data: bool</span>
<span class="sd">        :param load_data: Boolean telling if the data used for the computation can be read from computer files.</span>
<span class="sd">        :type load_data: bool</span>
<span class="sd">        :param n_jobs: Number of processes used to computed the source estimation</span>
<span class="sd">        :type n_jobs: int</span>
<span class="sd">        :param export_path: Path where the source space connectivity data will be stored.</span>
<span class="sd">        :type export_path: str</span>
<span class="sd">        :param psi: Check if the computation of the Phase Slope Index must be done. The PSI give an indication to the</span>
<span class="sd">        directionality of the connectivity.</span>
<span class="sd">        :type psi: bool</span>
<span class="sd">        :param fmin: Minimum frequency from which the envelope correlation will be computed.</span>
<span class="sd">        :type fmin: float</span>
<span class="sd">        :param fmax: Maximum frequency from which the envelope correlation will be computed.</span>
<span class="sd">        :type fmax: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signals</span> <span class="o">=</span> <span class="n">sourceSpaceConnectivityWorkerSignals</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">file_data</span> <span class="o">=</span> <span class="n">file_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connectivity_method</span> <span class="o">=</span> <span class="n">connectivity_method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectrum_estimation_method</span> <span class="o">=</span> <span class="n">spectrum_estimation_method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_estimation_method</span> <span class="o">=</span> <span class="n">source_estimation_method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_files</span> <span class="o">=</span> <span class="n">save_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_files</span> <span class="o">=</span> <span class="n">load_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">export_path</span> <span class="o">=</span> <span class="n">export_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">psi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span> <span class="o">=</span> <span class="n">fmin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span> <span class="o">=</span> <span class="n">fmax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subject</span> <span class="o">=</span> <span class="s2">&quot;fsaverage&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subjects_dir</span> <span class="o">=</span> <span class="n">get_project_freesurfer_path</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">source_space_connectivity_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">psi_data</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="sourceSpaceConnectivityRunnable.run"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sourceSpaceConnectivityRunnable.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Launch the computation of the source space connectivity on the given data.</span>
<span class="sd">        Notifies the main model when the computation is finished.</span>
<span class="sd">        If it is tried to load the source space information file, but that those file does not exist yet, an error message</span>
<span class="sd">        is displayed describing the error.</span>
<span class="sd">        If to extreme parameters are given and the computation fails, an error message is displayed describing the error.</span>
<span class="sd">        Notifies the main model when an error occurs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute_envelope_correlation_with_source_space</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_data_export</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;An error as occurred during the computation of the source space for the envelope correlation. </span><span class="se">\n</span><span class="s2">&quot;</span> \
                            <span class="s2">&quot;You can not load source estimation data if it has not been computed and saved earlier.&quot;</span>
            <span class="n">detailed_message</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="n">error_window</span> <span class="o">=</span> <span class="n">errorWindow</span><span class="p">(</span><span class="n">error_message</span><span class="p">,</span> <span class="n">detailed_message</span><span class="p">)</span>
            <span class="n">error_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;An error as occurred during the computation of the source space.&quot;</span>
            <span class="n">detailed_message</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="n">error_window</span> <span class="o">=</span> <span class="n">errorWindow</span><span class="p">(</span><span class="n">error_message</span><span class="p">,</span> <span class="n">detailed_message</span><span class="p">)</span>
            <span class="n">error_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span></div>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Utils</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="sourceSpaceConnectivityRunnable.check_data_export"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sourceSpaceConnectivityRunnable.check_data_export">[docs]</a>    <span class="k">def</span> <span class="nf">check_data_export</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if the source space connectivity data must be exported.</span>
<span class="sd">        If it is the case, create the file and write the data in it.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">export_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_space_connectivity_data</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">get_labels_from_subject</span><span class="p">(</span><span class="s2">&quot;fsaverage&quot;</span><span class="p">,</span> <span class="n">get_project_freesurfer_path</span><span class="p">())</span>
            <span class="n">label_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>

            <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_path</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
            <span class="c1"># Write header</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">label_names</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">label_names</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">label_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">label_names</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1"># Write data</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>     <span class="c1"># Source space area 1</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>  <span class="c1"># Source space area 2</span>
                    <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="sourceSpaceConnectivityRunnable.compute_envelope_correlation_with_source_space"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sourceSpaceConnectivityRunnable.compute_envelope_correlation_with_source_space">[docs]</a>    <span class="k">def</span> <span class="nf">compute_envelope_correlation_with_source_space</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Launch the computation of the source space if it is not provided.</span>
<span class="sd">        Once the source space is computed, compute the envelope correlation on this source space, giving the source space</span>
<span class="sd">        connectivity of the given data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_data</span><span class="o">.</span><span class="n">apply_baseline</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_data</span><span class="o">.</span><span class="n">set_eeg_reference</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_files</span><span class="p">:</span>
            <span class="n">inv</span> <span class="o">=</span> <span class="n">read_inverse_operator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">+</span> <span class="s2">&quot;-inv.fif&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_inverse_operator</span><span class="p">()</span>
        <span class="n">stcs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_inverse</span><span class="p">(</span><span class="n">inv</span><span class="p">)</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="n">get_labels_from_subject</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subject</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">subjects_dir</span><span class="p">)</span>
        <span class="n">label_ts</span> <span class="o">=</span> <span class="n">extract_label_time_course</span><span class="p">(</span><span class="n">stcs</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">inv</span><span class="p">[</span><span class="s1">&#39;src&#39;</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;mean_flip&#39;</span><span class="p">,</span> <span class="n">return_generator</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">sfreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_data</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;sfreq&quot;</span><span class="p">]</span>
        <span class="n">correlation_data</span> <span class="o">=</span> <span class="n">spectral_connectivity_epochs</span><span class="p">(</span><span class="n">label_ts</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connectivity_method</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spectrum_estimation_method</span><span class="p">,</span>
                                                        <span class="n">sfreq</span><span class="o">=</span><span class="n">sfreq</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span> <span class="n">faverage</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mt_adaptive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                        <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_space_connectivity_data</span> <span class="o">=</span> <span class="n">correlation_data</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi</span><span class="p">:</span>
            <span class="n">directionality_data</span> <span class="o">=</span> <span class="n">phase_slope_index</span><span class="p">(</span><span class="n">label_ts</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spectrum_estimation_method</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">psi_data</span> <span class="o">=</span> <span class="n">directionality_data</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span></div>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Source Space</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="sourceSpaceConnectivityRunnable.compute_inverse"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sourceSpaceConnectivityRunnable.compute_inverse">[docs]</a>    <span class="k">def</span> <span class="nf">compute_inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inv</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the inverse operator on the given data.</span>
<span class="sd">        :param inv: The inverse operator.</span>
<span class="sd">        :type inv: MNE.InverseOperator</span>
<span class="sd">        :return: The source estimation of all epochs.</span>
<span class="sd">        :rtype: list of MNE.SourceEstimate</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Apply inverse to epochs&quot;</span><span class="p">)</span>
        <span class="n">snr</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">lambda2</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">snr</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">stcs</span> <span class="o">=</span> <span class="n">apply_inverse_epochs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_data</span><span class="p">,</span> <span class="n">inv</span><span class="p">,</span> <span class="n">lambda2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">source_estimation_method</span><span class="p">,</span> <span class="n">pick_ori</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span>
                                    <span class="n">return_generator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">stcs</span></div>

<div class="viewcode-block" id="sourceSpaceConnectivityRunnable.create_inverse_operator"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sourceSpaceConnectivityRunnable.create_inverse_operator">[docs]</a>    <span class="k">def</span> <span class="nf">create_inverse_operator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Launch all the necessary computation to compute the inverse operator.</span>
<span class="sd">        :return: The inverse operator.</span>
<span class="sd">        :rtype: MNE.InverseOperator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compute all data necessary for creating inverse</span><span class="se">\n</span><span class="s2">===============================================&quot;</span><span class="p">)</span>
        <span class="n">noise_cov</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_noise_covariance</span><span class="p">()</span>
        <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_source_space</span><span class="p">()</span>
        <span class="n">bem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_bem_solution</span><span class="p">()</span>
        <span class="n">fwd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_forward_solution</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">bem</span><span class="p">)</span>
        <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_inverse_operator</span><span class="p">(</span><span class="n">fwd</span><span class="p">,</span> <span class="n">noise_cov</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">inv</span></div>

<div class="viewcode-block" id="sourceSpaceConnectivityRunnable.compute_noise_covariance"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sourceSpaceConnectivityRunnable.compute_noise_covariance">[docs]</a>    <span class="k">def</span> <span class="nf">compute_noise_covariance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the noise covariance of the given data.</span>
<span class="sd">        :return: The noise covariance.</span>
<span class="sd">        :rtype: MNE.Covariance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compute noise covariance&quot;</span><span class="p">)</span>
        <span class="n">noise_cov</span> <span class="o">=</span> <span class="n">compute_covariance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_data</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;shrunk&#39;</span><span class="p">,</span> <span class="s1">&#39;empirical&#39;</span><span class="p">],</span> <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_files</span><span class="p">:</span>
            <span class="n">noise_cov</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">+</span> <span class="s2">&quot;-cov.fif&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">noise_cov</span></div>

<div class="viewcode-block" id="sourceSpaceConnectivityRunnable.compute_source_space"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sourceSpaceConnectivityRunnable.compute_source_space">[docs]</a>    <span class="k">def</span> <span class="nf">compute_source_space</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the source space of the &quot;fsaverage&quot; model.</span>
<span class="sd">        :return: The source space</span>
<span class="sd">        :rtype: MNE.SourceSpaces</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compute source space&quot;</span><span class="p">)</span>
        <span class="n">src</span> <span class="o">=</span> <span class="n">setup_source_space</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subject</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="s1">&#39;oct6&#39;</span><span class="p">,</span> <span class="n">add_dist</span><span class="o">=</span><span class="s1">&#39;patch&#39;</span><span class="p">,</span> <span class="n">subjects_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subjects_dir</span><span class="p">,</span>
                                 <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_files</span><span class="p">:</span>
            <span class="n">write_source_spaces</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">+</span> <span class="s2">&quot;-src.fif&quot;</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">src</span></div>

<div class="viewcode-block" id="sourceSpaceConnectivityRunnable.compute_bem_solution"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sourceSpaceConnectivityRunnable.compute_bem_solution">[docs]</a>    <span class="k">def</span> <span class="nf">compute_bem_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the BEM solution of the &quot;fsaverage&quot; model.</span>
<span class="sd">        :return: The BEM solution.</span>
<span class="sd">        :rtype: MNE.ConductorModel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compute bem solution&quot;</span><span class="p">)</span>
        <span class="n">conductivity</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>  <span class="c1"># for three layers</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">make_bem_model</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subject</span><span class="p">,</span> <span class="n">ico</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">conductivity</span><span class="o">=</span><span class="n">conductivity</span><span class="p">,</span> <span class="n">subjects_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subjects_dir</span><span class="p">,</span>
                               <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">bem</span> <span class="o">=</span> <span class="n">make_bem_solution</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_files</span><span class="p">:</span>
            <span class="n">write_bem_solution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">+</span> <span class="s2">&quot;-bem-sol.fif&quot;</span><span class="p">,</span> <span class="n">bem</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bem</span></div>

<div class="viewcode-block" id="sourceSpaceConnectivityRunnable.compute_forward_solution"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sourceSpaceConnectivityRunnable.compute_forward_solution">[docs]</a>    <span class="k">def</span> <span class="nf">compute_forward_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">bem</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the forward solution of the given data, based on the source space model of the &quot;fsaverage&quot; model.</span>
<span class="sd">        :param src: The source space</span>
<span class="sd">        :type src: MNE.SourceSpaces</span>
<span class="sd">        :param bem: The BEM solution.</span>
<span class="sd">        :type bem: MNE.ConductorModel</span>
<span class="sd">        :return: The forward solution.</span>
<span class="sd">        :rtype: MNE.Forward</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compute forward solution&quot;</span><span class="p">)</span>
        <span class="n">fwd</span> <span class="o">=</span> <span class="n">make_forward_solution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_data</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="s1">&#39;fsaverage&#39;</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span> <span class="n">bem</span><span class="o">=</span><span class="n">bem</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">mindist</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_files</span><span class="p">:</span>
            <span class="n">write_forward_solution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">+</span> <span class="s2">&quot;-fwd.fif&quot;</span><span class="p">,</span> <span class="n">fwd</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fwd</span></div>

<div class="viewcode-block" id="sourceSpaceConnectivityRunnable.compute_inverse_operator"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sourceSpaceConnectivityRunnable.compute_inverse_operator">[docs]</a>    <span class="k">def</span> <span class="nf">compute_inverse_operator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fwd</span><span class="p">,</span> <span class="n">noise_cov</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the inverse operator of the given data, based on the forward solution and the noise covariance previously</span>
<span class="sd">        computed.</span>
<span class="sd">        :param fwd: The forward solution.</span>
<span class="sd">        :type fwd: MNE.Forward</span>
<span class="sd">        :param noise_cov: The noise covariance.</span>
<span class="sd">        :type noise_cov: MNE.Covariance</span>
<span class="sd">        :return: The inverse operator.</span>
<span class="sd">        :rtype: MNE.InverseOperator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compute inverse operator&quot;</span><span class="p">)</span>
        <span class="n">inverse_operator</span> <span class="o">=</span> <span class="n">make_inverse_operator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_data</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">fwd</span><span class="p">,</span> <span class="n">noise_cov</span><span class="p">,</span> <span class="n">loose</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_files</span><span class="p">:</span>
            <span class="n">write_inverse_operator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">+</span> <span class="s2">&quot;-inv.fif&quot;</span><span class="p">,</span> <span class="n">inverse_operator</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">inverse_operator</span></div>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Getters</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="sourceSpaceConnectivityRunnable.get_source_space_connectivity_data"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sourceSpaceConnectivityRunnable.get_source_space_connectivity_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_source_space_connectivity_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the source space connectivity&#39;s data.</span>
<span class="sd">        :return: The source space&#39;s data.</span>
<span class="sd">        :rtype: list of, list of float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_space_connectivity_data</span></div>

<div class="viewcode-block" id="sourceSpaceConnectivityRunnable.get_psi_data"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sourceSpaceConnectivityRunnable.get_psi_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_psi_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the psi&#39;s data.</span>
<span class="sd">        :return: The psi&#39;s data. Or nothing if the psi&#39;s data has not been computed.</span>
<span class="sd">        :rtype: list of, list of float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">psi_data</span></div></div>


<span class="c1"># Sensor Space Connectivity</span>
<div class="viewcode-block" id="sensorSpaceConnectivityWorkerSignals"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sensorSpaceConnectivityWorkerSignals">[docs]</a><span class="k">class</span> <span class="nc">sensorSpaceConnectivityWorkerSignals</span><span class="p">(</span><span class="n">QObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Contain the signals used by the sensor space connectivity runnable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">finished</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">()</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">()</span></div>


<span class="c1"># noinspection PyUnresolvedReferences</span>
<div class="viewcode-block" id="sensorSpaceConnectivityRunnable"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sensorSpaceConnectivityRunnable">[docs]</a><span class="k">class</span> <span class="nc">sensorSpaceConnectivityRunnable</span><span class="p">(</span><span class="n">QRunnable</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_data</span><span class="p">,</span> <span class="n">export_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runnable for the computation of the sensor space connectivity of the dataset.</span>
<span class="sd">        :param file_data: MNE data of the dataset.</span>
<span class="sd">        :type file_data: MNE.Epochs/MNE.Raw</span>
<span class="sd">        :param export_path: Path where the sensor space connectivity data will be stored.</span>
<span class="sd">        :type export_path: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signals</span> <span class="o">=</span> <span class="n">sensorSpaceConnectivityWorkerSignals</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">file_data</span> <span class="o">=</span> <span class="n">file_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">export_path</span> <span class="o">=</span> <span class="n">export_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor_space_connectivity_data</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="sensorSpaceConnectivityRunnable.run"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sensorSpaceConnectivityRunnable.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Launch the computation of the sensor space connectivity on the given data.</span>
<span class="sd">        Notifies the main model that the computation is finished.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sfreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_data</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;sfreq&quot;</span><span class="p">]</span>
            <span class="n">connectivity_data</span> <span class="o">=</span> <span class="n">spectral_connectivity_epochs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_data</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;pli&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;multitaper&#39;</span><span class="p">,</span> <span class="n">sfreq</span><span class="o">=</span><span class="n">sfreq</span><span class="p">,</span>
                                                             <span class="n">faverage</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">mt_adaptive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sensor_space_connectivity_data</span> <span class="o">=</span> <span class="n">connectivity_data</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;dense&#39;</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_data_export</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;An error as occurred during the computation of the sensor space connectivity.&quot;</span>
            <span class="n">error_window</span> <span class="o">=</span> <span class="n">errorWindow</span><span class="p">(</span><span class="n">error_message</span><span class="p">,</span> <span class="n">detailed_message</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
            <span class="n">error_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span></div>

<div class="viewcode-block" id="sensorSpaceConnectivityRunnable.check_data_export"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sensorSpaceConnectivityRunnable.check_data_export">[docs]</a>    <span class="k">def</span> <span class="nf">check_data_export</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if the sensor space connectivity data must be exported.</span>
<span class="sd">        If it is the case, create the file and write the data in it.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">export_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_space_connectivity_data</span>
            <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_data</span><span class="o">.</span><span class="n">ch_names</span>

            <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_path</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
            <span class="c1"># Write header</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">channels</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1"># Write data</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>  <span class="c1"># Channels 1</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>  <span class="c1"># Channels 2</span>
                    <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Getters</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="sensorSpaceConnectivityRunnable.get_sensor_space_connectivity_data"><a class="viewcode-back" href="../../../src.runnables.html#src.runnables.connectivity_runnable.sensorSpaceConnectivityRunnable.get_sensor_space_connectivity_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_sensor_space_connectivity_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the sensor space connectivity&#39;s data.</span>
<span class="sd">        :return: The sensor space&#39;s data.</span>
<span class="sd">        :rtype: list of, list of float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_space_connectivity_data</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">MNE Vision 0.1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2022, Lemahieu Antoine.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>